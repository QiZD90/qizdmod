Code adapted from MoriyaShiine's mod enchancement
https://github.com/MoriyaShiine/enchancement